import{getInstance as h,getInterface as j,runIfCode as c,msjsInstance as m,setRO as f}from"./runtime.esm.js";import{unifiedList as l}from"./unified-list.esm.js";import{NANOS as i}from"./vendor.esm.js";function k(e){const{octx:t,mp:n}=e,s=n.at(0);f(t,"js",s instanceof i?s:new i),f(e.js,m,e.rr,!1)}function u(e){const{mp:t}=e,n=t.has("path")?l(t.at("path")).values():t.values();let s=e.js;for(const a of n)if(s.has(a))s=l(s.at(a));else{if(t.has("else"))return c(t.at("else"));throw new Error("Key path not found")}return s}function y(){if(this.list.has(this.key))return this.list.at(this.key);if(this.hasElse)return c(this.elseVal);throw new Error(`Required key ${this.key} not present`)}function w(e){const{js:t,mp:n}=e,s=n.at(0),a=n.has("else"),r=n.at("else");return e.b({cd:y.bind({list:t,key:s,hasElse:a,elseVal:r})})}function x(e){return e.mp.has(0)?(e.js.next=e.mp.at(0),e.rr):e.js.next}function v(e){const{mp:t,js:n}=e;for(const s of t.entries())n.set(s[0],s[1])}function d(e){const{js:t,mp:n}=e;if(n.has(0)){let s=n.at(0);return s===!0&&(s=h("@reactive")("rio")),t.rio=s,e.rr}return!!t.rio}function g(e){this.list.set(this.key,e.mp.at(0))}function S(e){const{js:t,mp:n}=e,s=n.at(0);return e.b({cd:g.bind({list:t,key:s})})("fn")}const I=e=>{const t=typeof e;return t==="string"||t==="number"||t==="symbol"};function K(e){const{mp:t}=e,s=[...t.has("path")?l(t.at("path")).values():t.values()].filter(o=>I(o)),a=s.length-(t.has("to")?1:0);let r=e.js;for(let o=0;o<a;++o){const p=s[o];r.at(p)instanceof i||r.set(p,r.similar()),r=r.at(p)}t.has("to")?r.set(s[a],t.at("to"),t.at("insert")):(t.has("first")&&r.unshift(t.at("first")),t.has("next")&&r.push(t.at("next")))}function b(e){j(e).set({lock:!0,pristine:!0,handlers:{"@init":k,"@jsv":t=>t.js,at:u,clear:t=>t.js.clear(),copy:t=>new i().fromPairs(t.js.pairs()),delete:t=>t.js.delete(t.mp.at(0)),depend:t=>t.js.depend(),entries:t=>new i([...t.js.entries()]),get:u,getter:w,has:t=>t.js.has(t.mp.at(0)),includes:t=>t.js.includes(t.mp.at(0)),indexEntries:t=>new i([...t.js.indexEntries(t.mp.at(0))]),indexKeys:t=>new i([...t.js.indexKeys()]),isLocked:t=>t.js.isLocked(t.mp.at(0)),isRedacted:t=>t.js.isRedacted(t.mp.at(0)),keyOf:t=>t.js.keyOf(t.mp.at(0)),keyIter:t=>t.js.keys(),keys:t=>new i([...t.js.keys()]),lastKeyOf:t=>t.js.lastKeyOf(t.mp.at(0)),lock:t=>t.js.lock(...t.mp.indexValues()),lockAll:t=>t.js.lockAll(t.mp.at(0)),lockKeys:t=>t.js.lockKeys(),namedEntries:t=>new i([...t.js.namedEntries()]),namedKeys:t=>new i([...t.js.namedKeys()]),next:x,nset:v,pairs:t=>new i(t.js.pairs(t.mp.at(0))),pop:t=>t.js.pop(),push:t=>t.js.push(t.mp),push1:t=>t.js.push(t.mp.at(0)),redact:t=>t.js.redact(...t.mp.indexValues()),reverse:t=>t.js.reverse(),rio:d,self:t=>t.js,set:K,setter:S,shift:t=>t.js.shift(),size:t=>t.js.size,toJSON:t=>t.js.toJSON(),toReversed:t=>t.js.toReversed(),toSLID:t=>t.js.toSLID(t.mp?.storage||{}),toString:t=>t.js.toString(t.mp?.storage||{}),unshift:t=>t.js.unshift(t.mp),values:t=>new i([...t.js.values()])},cacheHints:{"@init":"pin",at:"pin",has:"pin",nset:"pin",set:"pin"}})}export{b as install};
