import{getInstance as N,getInterface as O,runIfCode as u,setRO as j}from"./runtime.esm.js";import{unifiedList as f,uniAt as y}from"./unified-list.esm.js";function k(s){const{octx:t,mp:e}=s,n=e.at(0);j(t,"js",n instanceof NANOS?n:new NANOS),j(s.rr,{jsv:s.js,valueOf:()=>s.js})}function l(s){const{mp:t}=s,e=t.has("path")?f(t.at("path")).values():t.values();return y(s.js,[...e],{wrap:!0,raw:t.at("raw"),defaultFn:()=>{if(t.has("else"))return u(t.at("else"));throw new Error("Key path not found")}})}function S(){if(this.list.has(this.key))return this.list.at(this.key);if(this.hasElse)return u(this.elseVal);throw new Error(`Required key ${this.key} not present`)}function w(s){const{js:t,mp:e}=s,n=e.at(0),o=e.has("else"),r=e.at("else");return s.b({cd:S.bind({list:t,key:n,hasElse:o,elseVal:r})})}function A(s){return s.mp.has(0)?(s.js.next=s.mp.at(0),s.rr):s.js.next}function h(s){const{mp:t,js:e}=s;for(const n of t.namedEntries())e.set(n[0],n[1])}function v(s){const{js:t,mp:e}=s;if(e.has(0)){let n=e.at(0);return n===!0&&(n=N("@reactive")("rio")),t.rio=n,s.rr}return!!t.rio}function x(s){const t=s.mp,e=t.at("insert"),n=t.at("raw");this.list.set(this.key,s.mp.at(0),{insert:e,raw:n})}function E(s){const{js:t,mp:e}=s,n=e.at(0);return s.b({cd:x.bind({list:t,key:n})})("fn")}const g=s=>{const t=typeof s;return t==="string"||t==="number"||t==="symbol"};function m(s){const{mp:t}=s,e=t.has("path")?f(t.at("path")).values():t.values(),n=t.at("insert"),o=t.at("raw"),r=[...e].filter(a=>g(a)),c=r.length-(t.has("to")?1:0);let i=s.js;for(let a=0;a<c;++a){const p=r[a];i.at(p)instanceof NANOS||i.set(p,i.similar()),i=i.at(p)}t.has("to")?i.set(r[c],t.at("to"),{insert:n,raw:o}):(t.has("first")&&i.unshift(t.at("first")),t.has("next")&&i.push(t.at("next")))}function K(s){return s.js.setOpts(Object.fromEntries(s.mp.namedEntries())),s.rr}function b(s){O(s).set({lock:!0,pristine:!0,handlers:{"@init":k,"@jsv":t=>t.js,"@":l,"==":h,">":t=>t.js.pop(),"|+":t=>t.js.push(t.mp),"=":m,"<":t=>t.js.shift(),"+|":t=>t.js.unshift(t.mp),at:l,clear:t=>t.js.clear(),copy:t=>new NANOS().fromPairs(t.js.pairs()),delete:t=>t.js.delete(t.mp.at(0)),depend:t=>t.js.depend(),entries:t=>new NANOS([...t.js.entries()]),get:l,getter:w,has:t=>t.js.has(t.mp.at(0)),includes:t=>t.js.includes(t.mp.at(0)),indexEntries:t=>new NANOS([...t.js.indexEntries(t.mp.at(0))]),indexKeys:t=>new NANOS([...t.js.indexKeys()]),isLocked:t=>t.js.isLocked(t.mp.at(0)),isRedacted:t=>t.js.isRedacted(t.mp.at(0)),keyOf:t=>t.js.keyOf(t.mp.at(0)),keyIter:t=>t.js.keys(),keys:t=>new NANOS([...t.js.keys()]),lastKeyOf:t=>t.js.lastKeyOf(t.mp.at(0)),lock:t=>t.js.lock(...t.mp.indexValues()),lockAll:t=>t.js.lockAll(t.mp.at(0)),lockKeys:t=>t.js.lockKeys(),namedEntries:t=>new NANOS([...t.js.namedEntries()]),namedKeys:t=>new NANOS([...t.js.namedKeys()]),next:A,nset:h,options:t=>new NANOS(t.js.options),pairs:t=>new NANOS(t.js.pairs(t.mp.at(0))),pop:t=>t.js.pop(),push:t=>t.js.push(t.mp),push1:t=>t.js.push(t.mp.at(0)),redact:t=>t.js.redact(...t.mp.indexValues()),reverse:t=>t.js.reverse(),rio:v,self:t=>t.js,set:m,setOpts:K,setter:E,shift:t=>t.js.shift(),size:t=>t.js.size,toJSON:t=>t.js.toJSON(),toReversed:t=>t.js.toReversed(),toSLID:t=>t.js.toSLID(t.mp?.storage||{}),toString:t=>t.js.toString(t.mp?.storage||{}),unshift:t=>t.js.unshift(t.mp),values:t=>new NANOS([...t.js.values()])},cacheHints:{"@init":"pin",at:"pin",has:"pin",nset:"pin",set:"pin"}})}export{b as install};
