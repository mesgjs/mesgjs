{
  "version": 3,
  "sources": ["../../src/runtime/runtime.esm.js"],
  "sourcesContent": ["/*\n * Mesgjs Runtime Interface And Messaging Support\n * Author: Brian Katzung <briank@kappacs.com>\n * Copyright 2025 by Kappa Computer Solutions, LLC and Brian Katzung\n *\n * Wrapping objects (generating message gateways)\n * Sending and receiving messages\n * Defining interfaces and dispatching handlers in response to messages\n */\nimport { calcDigest, getIntegritySHA512 } from './calc-digest.esm.js';\nimport { NANOS, isIndex, parseQJSON, parseSLID } from './vendor.esm.js';\nimport { SieveCache } from './sieve-cache.esm.js';\nimport { unifiedList } from './unified-list.esm.js';\nimport './shim.esm.js';\n\nconst gt = globalThis;\nexport const msjsInstance = Symbol.for('msjsInstance');\n\n// Flow exception, e.g. @d(return value) throws MSJSFlow('return', value)\nexport class MSJSFlow extends Error {\n    constructor (message, info) {\n\tsuper(message);\n\tif (info !== undefined) this.info = info;\n    }\n\n    get name () { return 'MSJSFlow'; }\n}\nexport class MSJSFlowError extends RangeError {\n    constructor (...a) {\n\tsuper(...a);\n\tthis.name = 'MSJSFlowError';\n    }\n};\n\nexport async function calcIntegrity (src) {\n    return calcDigest(await fetchModule(src, { decode: false }), 'SHA-512');\n}\n\nexport async function fetchModule (host, path, { decode, integrity } = {}) {\n    const src = host ? `${host}/${path}` : path;\n    let data;\n    if (host) data = await fetch(src).arrayBuffer();\n    if (typeof Deno !== 'undefined') data = await Deno.readFile(path);\n    if (!data) return new Error(`fetchModule: File \"${path}\" not found`);\n    if (integrity && await calcDigest(data, 'SHA-512') !== integrity) return new Error(`fetchModule: File \"${src}\" integrity verification failed`);\n    return ((decode === false) ? data : new TextDecoder().decode(data));\n}\n\n// listFromPairs is the runtime shortcut ls([]) (NANOS generator)\nexport const listFromPairs = pa => new NANOS().fromPairs(pa);\n\n// Types to show in place of values during dispatch/stack traces\nexport function loggedType (v) {\n    if (v?.msjsType) return 'S.' + v.msjsType;\n    const jt = typeof v;\n    switch (jt) {\n    case 'boolean': return (v ? '@t' : '@f');\n    case 'undefined': return '@u';\n    case 'object':\n\tif (v === null) return '@n';\n\treturn 'J.' + (v?.constructor?.name || 'Object');\n    default: return 'J.' + jt;\n    }\n}\n\n// namespaceAt is the runtime shortcut na(...) (NANOS .at)\nexport function namespaceAt  (namespace, key, opt) {\n    if (namespace?.has && namespace.has(key)) return namespace.at(key);\n    if (!opt) throw new ReferenceError(`Required key \"${key}\" not found`);\n}\n\n// Get the return value if @code, or the raw value otherwise\nexport const runIfCode = v => v?.msjsType === '@code' ? v('run') : v;\n\n// Send an anonymous message (promoting JS receiver objects as necessary)\nexport function sendAnonMessage (rr, op, mp) {\n    if (!rr?.msjsType) rr = gt.$toMSJS(rr);\n    return rr(op, mp);\n}\n\n// Return a message sender's source file/line/column\nexport function senderFLC () {\n    const stack = (new Error().stack || '').split('\\n');\n    // Discard stack frames through the object's msjsR$ receiver (public i/f fn)\n    while (stack.length) if (/msjsR\\$/.test(stack.shift())) break;\n    // Also discard sender's msjsS$ frames for attributed messages\n    while (/msjsS\\$/.test(stack[0])) stack.shift();\n    const srFrame = stack[0] || '';\n    const match = srFrame.match(/[@(](.*):(\\d+):(\\d+)/) ||\n\tsrFrame.match(/(?:^|\\s+)at\\s+(.*):(\\d+):(\\d+)$/);\n    if (match) return { file: match[1], line: parseInt(match[2]), column: parseInt(match[3]) };\n}\n\n// Set a read-only object property or properties\n// setRO(obj, key, value, enumerable = true)\n// setRO(obj, { map }, enumerable = true)\nconst sROProp = { writable: false, configurable: false };\nexport const setRO = (o, ...a) => {\n    if (typeof a[0] === 'object') {\n\tconst [map, enumerable = true] = a;\n\tsROProp.enumerable = enumerable;\n\tfor (const k of Object.keys(map)) {\n\t    sROProp.value = map[k];\n\t    Object.defineProperty(o, k, sROProp);\n\t}\n    } else {\n\tconst [key, value, enumerable = true] = a;\n\t[ sROProp.value, sROProp.enumerable ] = [ value, enumerable ];\n\tObject.defineProperty(o, key, sROProp);\n    }\n    return o;\n};\n\nexport function throwFlow (d, type, ifName) {\n    const { js, mp } = d;\n    if (!js.active) throw new MSJSFlowError(`(${type}) to inactive ${ifName}`);\n    js.capture = true;\n    if (mp.has('result')) {\n\tjs.hasFlowRes = true;\n\tjs.flowRes = mp.at('result');\n    }\n    throw new MSJSFlow(type);\n}\n\nconst hasOwn = Object.hasOwn;\n\n//////////////////////////////////////////////////////////////////////\n// START Of Code/Interface/Messaging Protected Zone\n//////////////////////////////////////////////////////////////////////\nexport const {\n    debugConfig,\n    fcheck,\n    fready,\n    fwait,\n    getInstance,\n    getInterface,\n    initialize,\n    loadModule,\n    logInterfaces,\n    moduleScope,\n    setModMeta,\n    typeAccepts,\n    typeChains,\n} = (() => {\n    let codeBaton, mesgBaton, nextAnon = 0, nextUCID = 0, initPhase = 2, dispNo = 0;\n    const getCode = Symbol('getCode'), initSym = Symbol('@init');\n    const interfaces = Object.create(null), firstInit = [];\n    const dbgCfg = Object.setPrototypeOf({\n\tdispatch: false, dispatchSource: false, dispatchTypes: false,\n\tstack: 0, stackSource: false, stackTypes: false,\n    }, null), stack = [], hdr = '-- Mesgjs Dispatch Stack --';\n    const handlerCache = new SieveCache(1024);\n    const dacHandMctx = { st: '@core', rt: '@core', sm: sendAnonMessage };\n    const modLoaded = new Set(), features = new Map(), modMeta = new NANOS(), modMap = new Map();\n\n    // Assemble the feature map from modules or host modules.\n    function addModFeatures (mods) {\n\tfor (const modKey of mods.keys() || []) {\n\t    // Only add features for verifiable mods\n\t    const modInf = mods.at(modKey);\n\t    if (!getIntegritySHA512(modInf?.at('integrity'))) continue;\n\t    for (const f of modInf?.at('featpro')?.values() || []) if (!features.has(f)) {\n\t\tconst prom = getInstance('@promise');\n\t\tprom.catch(() => console.log(`loadModule: Feature \"${f}\" rejected`));\n\t\tfeatures.set(f, prom);\n\t    }\n\t}\n    }\n\n    // Add some or all of our Mesgjs stack trace to the JS one\n    function appendStackTrace (e) {\n\tif (!stack.length || !e.stack?.includes || e.stack.includes(hdr)) return;\n\tconst frames = [], stop = dbgCfg.stack;\n\tlet down = stack.length;\n\tfor (let up = 0; --down >= 0; ) {\n\t    const curFrm = stack[down], disp = curFrm.disp;\n\t    const dispOp = (typeof disp.op === 'symbol') ? 'J.Symbol' : disp.op;\n\t    frames.push(`${disp.st} => ${disp.rt}(${dispOp}${fmtDispParams(dbgCfg.stackTypes, disp.mp)})${fmtDispSrc(dbgCfg.stackSource,curFrm)}`);\n\t    if (++up === stop) break;\n\t}\n\tif (down >= 0) frames.push('[...]');\t// Config stopped us early\n\te.stack += '\\n' + hdr + '\\n' + frames.join('\\n');\n    }\n\n    // Bind a code template to a dispatch object and save it\n    function bindCode (tpl, disp) {\n\tif (tpl.ucid === undefined) setRO(tpl, 'ucid', nextUCID++);\n\treturn ((disp._bc ||= [])[tpl.ucid] ||= newMSJSCode(tpl.cd, disp));\n    }\n\n    /*\n     * Return canonical message properties\n     * sr, st, rr, rt, op, mp, hasElse, elseExpr\n     *\n     * - Checks (and clears) the message baton\n     * - Processes (NANOS or plain JS object) list-op messages\n     */\n    function canMesgProps (ctx, checkBaton = true) {\n\tlet sr, st, { rr, rt, op, mp } = ctx, hasElse = false, elseExpr;\n\tif (checkBaton) {\n\t    const mb = mesgBaton;\n\t    mesgBaton = undefined;\n\t    if (op === undefined && mb?.rr === rr) ({ sr, st, op, mp } = mb);\n\t}\n\tif (op instanceof NANOS) op = op.storage;\n\tif (typeof op === 'object') {\t// List-op message\n\t    const hp = prop => hasOwn(op, prop);\n\t    if (hp('else')) [ hasElse, elseExpr ] = [ true, op.else ];\n\t    if (hp('params')) mp = op.params;\n\t    if (hp('op')) op = op.op;\n\t    else if (hp('0')) op = op[0];\n\t    else throw new SyntaxError('Missing operation in Mesgjs list-op message');\n\t}\n\tif (!(mp instanceof NANOS)) mp = new NANOS(mp ?? []);\n\treturn { sr, st, rr, rt, op, mp, hasElse, elseExpr };\n    }\n\n    // Core version of getInstance (works with public interfaces)\n    function coreGetInstance (type, mp) {\n\tconst ix = interfaces[type];\n\tif (ix && !ix.private) return getInstance(type, mp);\n    }\n\n    // Optionally set, and then return, debugging configuration\n    function debugConfig (set) {\n\tset = unifiedList(set);\n\tfor (const k of Object.keys(dbgCfg)) {\n\t    const type = typeof dbgCfg[k];\n\t    switch (type) {\n\t    case 'boolean':\n\t\tif (set.has(k)) dbgCfg[k] = !!set.at(k);\n\t\tbreak;\n\t    case 'number':\n\t    {\n\t\tconst v = set.at(k);\n\t\t// deno-lint-ignore valid-typeof\n\t\tif (typeof v === type) dbgCfg[k] = v;\n\t\tbreak;\n\t    }\n\t    }\n\t}\n\treturn new NANOS(dbgCfg);\n    }\n\n    // Shared JS getters & methods for @dispatch interface functions\n    const dispProto = Object.setPrototypeOf({\n\t// Return code bound to this dispatch\n\tb (tpl) { return bindCode(tpl, this); },\n\tget js () { return this.octx.js; },\n\t// JIT persistent storage NANOS\n\tget p () { return this.octx.ps ??= new NANOS(); },\n\tget msjsType () { return '@dispatch'; },\n\t// JIT transient (scratch) storage NANOS\n\tget t () { return this._ts ??= new NANOS(); },\n    }, Object.getPrototypeOf(Function));\n\n    // Dispatch a handler, passing it a fresh @dispatch object\n    function dispatchHandler (mctx, dhctx, mp) {\n\tconst { sr, st, rr, rt } = mctx; // message context\n\tconst { op, octx, handler, sm } = dhctx; // dH context\n\n\t/*\n\t * As part of the messaging pathway, dispatch objects have custom\n\t * receiver functions.\n\t */\n\tconst bfnThis = {}, disp = bfnThis.bfn = Object.setPrototypeOf(msjsR$Dispatch.bind(bfnThis, mctx, dhctx, mp), dispProto);\n\tdisp.dop = op;\n\tdisp.ht = handler.type;\n\tdisp.mop = mctx.op;\n\tdisp.mp = mp;\n\tdisp.octx = octx;\n\tdisp.rr = rr;\n\tdisp.rt = rt;\n\tdisp.sm = sm;\n\tdisp.sr = sr;\n\tdisp.st = st;\n\n\tconst trace = dbgCfg.stack, thisDisp = dbgCfg.dispatch && (dispNo++).toString(16);\n\ttry {\n\t    if (dbgCfg.dispatch) {\n\t\tconst dispOp = (typeof disp.op === 'symbol') ? 'J.Symbol' : disp.op;\n\t\tconsole.log(`[Mesgjs dispatch ${thisDisp}] ${st} => ${rt}${handler.type === rt ? '' : ('/' + handler.type)}(${dispOp}${fmtDispParams(dbgCfg.dispatchTypes, disp.mp)})${fmtDispSrc(dbgCfg.dispatchSource)}`);\n\t    }\n\t    if (trace) stack.push({ disp, ...(dbgCfg.stackSource && senderFLC() || {}) });\n\t    const result = handler.code(disp);\n\t    if (thisDisp !== false) console.log(`[Mesgjs return ${thisDisp}]${fmtDispParams(dbgCfg.dispatchTypes, [ result ])}`);\n\t    return result;\n\t}\n\tcatch (e) {\n\t    if (disp._capture && e instanceof MSJSFlow) {\n\t\tdisp._capture = false;\n\t\tif (thisDisp !== false) console.log(`[Mesgjs return ${thisDisp}]${fmtDispParams(dbgCfg.dispatchTypes, [ e.info ])}`);\n\t\treturn e.info;\n\t    }\n\t    if (thisDisp !== false) console.log(`[Mesgjs exception ${thisDisp}]`, e);\n\t    if (trace && !(e instanceof MSJSFlow)) appendStackTrace(e);\n\t    throw e;\n\t}\n\tfinally {\n\t    if (trace) stack.pop();\n\t}\n\t// Not reached\n    }\n\n    // Handle an incoming message's first dispatch\n    function dispatchMessage (mctx, dctx) {\n\tconst cmp = canMesgProps(mctx);\n\tconst { st, rr, rt, op, mp, hasElse, elseExpr } = cmp;\n\tconst { octx, handler = getHandler(rt, op) } = dctx;\n\n\tif (!handler) {\n\t    if (dbgCfg.dispatch) console.log(`[Mesgjs dispatch] ${st} => ${rt}(${op}) [NO HANDLER]${fmtDispSrc(dbgCfg.dispatchSource)}`);\n\t    if (hasElse) return runIfCode(elseExpr);\n\t    throw new TypeError(`No Mesgjs handler found for \"${rt}(${op})\"`);\n\t}\n\n\t// Send-message function (shared across all dispatches)\n\tconst sm = msjsS$SendMessage.bind({ sr: rr, st: rt });\n\n\t// Dispatch the initial handler and return its result\n\treturn dispatchHandler(cmp, { octx, op, handler, sm }, mp);\n    }\n    firstInit.push(() => {\n\tgetInterface('@dispatch').set({ pristine: true, private: true, lock: true });\n\tstub('@dispatch', 'ht', 'js', 'op', 'redis', 'return', 'rr', 'rt', 'sr', 'st');\n    });\n\n    // Return flattened chain set by interface type\n    function flatChain (type) {\n\tconst ix = interfaces[type];\n\tif (!ix) return new Set();\n\tlet fc = ix.flatChain;\n\tif (!fc) {\n\t    fc = new Set([type]);\n\t    for (const nxt of ix.chain) if (!fc.has(nxt)) fc = fc.union(flatChain(nxt));\n\t    ix.flatChain = fc;\n\t}\n\treturn fc;\n    }\n\n    // Format dispatch message parameter types\n    function fmtDispParams (inc, list) {\n\tif (!inc) return '';\n\treturn [...unifiedList(list).entries()].map(en => (isIndex(en[0]) ? ` ${loggedType(en[1])}` : ` ${en[0]}=${loggedType(en[1])}`)).join('');\n    }\n\n    // Format a dispatched message source file / line / column\n    function fmtDispSrc (inc, flc) {\n\tif (inc) {\n\t    if (!flc) flc = senderFLC();\n\t    if (flc?.line !== undefined) return ` at ${flc.file}:${flc.line}:${flc.column}`;\n\t}\n\treturn '';\n    }\n\n    // Non-blocking feature check\n    function fcheck (f) {\n\tswitch (features.get(f)?.state) {\n\tcase 'pending': return false;\t// @f: not ready\n\tcase 'resolved': return true;\t// @t: ready\n\t}\n\t// no such feature, or mod load rejected: @u\n    }\n\n    // Wait for a list of features to be ready\n    function fwait (...list) {\n\tconst prom = getInstance('@promise'), proms = [];\n\tprom.catch(() => {});\n\tfor (const f of list) if (features.has(f)) proms.push(features.get(f));\n\treturn prom.all(proms);\n    }\n\n    // Mark a feature ready (if module is authorized)\n    function fready (mid, f) {\n\tconst meta = modMap.get(mid);\n\tif (meta && meta.featpro?.includes(f)) features.get(f)?.resolve();\n    }\n\n    /*\n     * Try to locate a specific or default handler for a type and operation.\n     * Returns {code, type, op}.\n     */\n    function getHandler (type0, op, next = false) {\n\tconst noopHandler = { code: () => {}, type: type0, op };\n\t// Ignore (no-op) @init outside of getInstance\n\tif (op === '@init') return noopHandler;\n\tif (op === initSym) op = '@init';\n\tconst cacheKey = typeof type0 === 'string' && typeof op === 'string' && `${type0}(${op})`, hit = cacheKey && handlerCache.get(cacheKey);\n\tif (hit) return hit;\n\n\tconst handler = getHandler2(type0, op, next, noopHandler);\n\tconst cacheable =\n\t    ((!cacheKey || !handler || !interfaces[handler.type].locked) ? false :\n\t    ((handler.code.cache !== undefined) ? handler.code.cache :\n\t    (handler.op !== op || handler.type !== type0)));\n\tif (cacheable) handlerCache.set(cacheKey, handler, handler.code.cache === 'pin' && handler.type === type0);\n\treturn handler;\n    }\n    function getHandler2 (type0, op, next, noopHandler) {\n\tlet dacHand, defHand;\n\tfor (const type of flatChain(type0)) {\n\t    if (next && type === type0) continue;\n\t    const ix = interfaces[type], code = ix?.handlers[op];\n\t    if (code) return { code, type, op };\n\t    if (ix && !defHand) {\n\t\tif (!dacHand) {\n\t\t    const op = '@defacc', code = ix.handlers[op];\n\t\t    if (code) dacHand = { code, type, op };\n\t\t}\n\t\tconst op = '@default', code = ix.handlers[op];\n\t\tif (code) defHand = { code, type, op };\n\t    }\n\t}\n\t// Use no-op as the special default for @init\n\tif (op === '@init') return noopHandler;\n\t// @defacc can moderate what @default accepts\n\tif (defHand && dacHand && !dispatchHandler(dacHandMctx, { op: '@defacc', octx: {}, handler: dacHand }, { op, type: defHand.type })) return;\n\treturn defHand;\n    }\n\n    /*\n     * Return a new object instance of the specified type.\n     * The JS initializer is called if one is configured in the interface.\n     */\n    function getInstance (type, mp) {\n\tconst ix = interfaces[type];\n\tif (!ix) throw new TypeError(`Cannot get instance for unknown Mesgjs interface \"${type}\"`);\n\tif (ix.instance) return ix.instance;\n\tconst octx = Object.create(null), pi = function msjsR$Object (op, mp) { return dispatchMessage({ rr: pi, rt: type, op, mp }, { octx }); };\n\tsetRO(pi, 'msjsType', type);\n\tif (ix.singleton) ix.instance = pi;\n\tix.refd = true;\n\tif (!(mp instanceof NANOS)) mp = new NANOS(mp ?? []);\n\tpi(initSym, mp);\n\treturn pi;\n    }\n\n    /*\n     * Return a MSJS interface management object.\n     * As part of the foundation for the object messaging system, it uses\n     * a custom message receiver function.\n     */\n    function getInterface (name) {\n\tif (name === '?') name = '?' + nextAnon++;\n\telse if (typeof name !== 'string' || !name || (name[0] === '?' && !interfaces[name]) || (name[0] === '@' && initPhase !== 1)) return;\n\tconst ix = interfaces[name], isFirst = !ix;\n\tif (isFirst) interfaces[name] = {\n\t    handlers: Object.create(null), chain: new Set([]), refd: false,\n\t    abstract: false, final: false, locked: false,\n\t    once: false, pristine: true, singleton: false\n\t};\n\tif (ix?.once) return;\n\tconst bfnThis = { name, isFirst }, bfn = bfnThis.bfn = msjsR$Interface.bind(bfnThis);\n\treturn setRO(bfn, {\n\t    ifName: name,\n\t    set: mp => setInterface(name, mp, isFirst),\n\t    instance: mp => getInstance(name, mp),\n\t    msjsType: '@interface',\n\t});\n    }\n    firstInit.push(() => {\n\tgetInterface('@interface').set({ pristine: true, private: true, lock: true });\n\tstub('@interface', 'instance', 'name', 'set');\n    });\n\n    // Determine next-level message params for redispatch\n    function getRDMP (mp) {\n\tconst raw = mp.at('params', mp);\n\treturn ((raw instanceof NANOS) ? raw : new NANOS(raw ?? []));\n    }\n\n    // Initialize the runtime environment (e.g. load core, core extensions)\n    function initialize () {\n\tif (initPhase === 2) {\t\t// Only initialize once\n\t    initPhase = 1;\n\t    firstInit.forEach(cb => cb());\n\t    globalThis.installMSJSCoreExtensions();\n\t    initPhase = 0;\n\t    dacHandMctx.sr = dacHandMctx.rr = gt.$c;\n\t}\n    }\n\n    async function loadModule (src) {\n\t// Prevent reload by source\n\tif (modLoaded.has('src-' + src)) return;\n\tmodLoaded.add('src-' + src);\n\n\tconst meta = modMeta?.at('modules')?.at(src);\n\tconst expect = getIntegritySHA512(meta?.at('integrity'));\n\tif (expect) {\n\t    // Prevent reload by signature\n\t    if (modLoaded.has(expect)) return;\n\t    modLoaded.add(expect);\n\t} else {\n\t    if (globalThis.msjsModMeta) throw new Error(`loadModule: Refusing unverified module \"${src}\"`);\n\t    console.log(`loadModule WARNING: Module \"${src}\" is unverified`);\n\t}\n\n\tsrc = remapModURL(src, meta);\n\tconst code = await fetchModule(src, { integrity: expect });\n\tif (code instanceof Error) {\n\t    // Reject this module's features, if any\n\t    for (const f of meta?.at('featpro')?.values() || []) features.get(f)?.reject(code);\n\t    throw code;\n\t}\n\n\tif (meta) {\n\t    const mid = Symbol();\n\t    meta.set('mid', mid);\n\t    modMap.set(expect, meta);\n\t    modMap.set(mid, meta);\n\t}\n\tconst URL = (typeof Blob === 'function' && typeof URL?.createObjectURL === 'function') ?\n\t    URL.createObjectURL(new Blob([ new TextEncoder().encode(code) ], { type: 'application/javascript' })) :\n\t    `data:application/javascript;base64,${btoa(code)}`;\n\tconst mod = await import(URL);\n\tif (URL.startsWith('blob:')) URL.revokeObjectURL(URL);\n\tif (globalThis.msjsModMeta && mod.loadMSJS) mod.loadMSJS(meta?.mid);\n    }\n\n    function logInterfaces () { console.log(interfaces); }\n\n    // Return a module dispatch object\n    function moduleScope () {\n\tconst m = function msjsR$Module () {}, d = function msjsR$Dispatch (op) {\n\t    ({ op } = canMesgProps({ rr: d, op }));\n\t    switch (op) {\n\t    case 'op': return 'load';\n\t    case 'rr': case 'sr': return m;\n\t    case 'rt': case 'st': return '@module';\n\t    // Quietly ignore other messages\n\t    }\n\t};\n\tlet per, tra;\t// JIT persistent, transient storage\n\tconst b = tpl => bindCode(tpl, d), sm = msjsS$SendMessage.bind({ sr: m, st: '@module' }), getPer = () => (per ??= new NANOS()), getTra = () => (tra ??= new NANOS());\n\tsetRO(m, 'msjsType', '@module');\n\tObject.defineProperties(m, {\n\t    p: { get: getPer, enumerable: true },\n\t    t: { get: getTra, enumerable: true },\n\t});\n\tsetRO(d, {\n\t    sr: m, st: '@module', rr: m, rt: '@module', msjsType: '@dispatch',\n\t    octx: gt.$u, op: 'load', mp: gt.$u, b, sm,\n\t});\n\tObject.defineProperties(d, {\n\t    p: { get: getPer, enumerable: true },\n\t    t: { get: getTra, enumerable: true },\n\t});\n\treturn { d, m,\n\t    ls: listFromPairs,\n\t    na: namespaceAt,\n\t};\n    }\n    firstInit.push(() => {\n\tgetInterface('@module').set({ pristine: true, private: true, lock: true });\n    });\n\n    // Return a new MSJS @code object given code and a dispatch\n    function newMSJSCode (cd, od) {\n\t// Encapsulate the code with a custom receiver function (public i/f)\n\tconst bfnThis = { cd, od }, bfn = bfnThis.bfn = msjsR$Code.bind(bfnThis);\n\treturn setRO(bfn, 'msjsType', '@code');\n    }\n\n    // Return a new MSJS @function object given code and state\n    function newMSJSFunction (cd, ps) {\n\tconst type = '@function', octx = {};\n\tconst bfnThis = { octx, op: 'call', handler: { code: cd, type, op: 'call' } };\n\tif (ps !== undefined) setRO(octx, 'ps', ps);\n\tconst bfn = bfnThis.bfn = msjsR$Function.bind(bfnThis);\n\tbfnThis.sm = msjsS$SendMessage.bind({ sr: bfn, st: type });\n\treturn setRO(bfn, 'msjsType', type);\n    }\n    firstInit.push(() => {\n\tgetInterface('@code').set({ pristine: true, private: true, lock: true,\n\t    handlers: {\n\t\trun: false, fn: false,\n\t    },\n\t});\n\tgetInterface('@function').set({ pristine: true, private: true, lock: true,\n\t    handlers: {\n\t\tcall: false, fn: false,\n\t    },\n\t});\n\tgetInterface('@handler').set({ pristine: true, private: true, lock: true });\n    });\n\n    // Use modMeta to remap the module source location\n    function remapModURL (src, meta) {\n\t// Use an exact URL if one was provided\n\tconst url = meta?.at('url');\n\tif (url) return url;\n\n\t// Revise based on prefix mapping\n\tconst prefixMap = modMeta.at('prefixMap');\n\tlet best = [ '', 0 ];\n\tfor (const [ input, output ] of prefixMap.entries()) {\n\t    const len = input.length;\n\t    if (len > best[1] && src.startsWith(input)) best = [ output, len ];\n\t}\n\tsrc = best[0] + src.substring(best[1]);\n\n\t// /base + version => /base/major/base@version\n\tconst version = meta?.at('version'), [ , major ] = version && version.match(/(\\d+)/) || [];\n\tif (version && major !== undefined) {\n\t    const [ , dir, base ] = src.match(/(.*\\/)?(.*)(?:(?:\\.esm)?\\.js)?$/);\n\t    src = `${dir}${base}/${major}/${base}@${version}`;\n\t}\n\n\tif (!src.endsWith('.js')) src += '.esm.js';\n\treturn src;\n    }\n\n    // Prototype @code receiver\n    function msjsR$Code (op0, mp0) {\n\tconst cmp = canMesgProps({ rr: this.bfn, op: op0, mp: mp0 }), { op, mp, hasElse, elseExpr } = cmp;\n\t// Fast-track (run) message\n\tif (op === 'run') return this.cd(this.od);\n\tswitch (op) {\t// Standard-mode ops\n\tcase initSym: return;\n\tcase getCode:\n\t    codeBaton = { code: this.cd }; // JS function for interface\n\t    return;\n\tcase 'fn':\t\t\t// Return new function code block\n\t    return newMSJSFunction(this.cd, mp);\n\t}\n\tif (hasElse) return runIfCode(elseExpr);\n\tthrow new TypeError(`No Mesgjs handler found for \"@code(${op})\"`);\n    }\n\n    /*\n     * Prototype @dispatch receiver\n     * Accepts original message context, dispatch context, and\n     * dispatched message params.\n     */\n    function msjsR$Dispatch (mctx, dhctx, _dmp) {\n\t// Note: op/mp here is for the d(message), not the original (mctx)\n\tconst { op, mp, elseExpr } = canMesgProps({ rr: this.bfn });\n\tconst { octx, handler, sm } = dhctx;\n\tswitch (op) {\n\tcase 'dop': return dhctx.op;\t// Current dispatch REQUESTED op\n\tcase 'ht': return handler.type;\n\tcase 'js': return octx.js;\t// JavaScript state\n\tcase 'log':\t\t// Log the entire dispatch to the console\n\t    console.dir(this.bfn, { depth: null });\n\t    return;\n\tcase 'mop': return mctx.op;\t// Original message requested op\n\tcase 'redis':\t\t// Redispatch\n\t{\n\t    // Accept either list-op or mp else parameter\n\t    const dispElse = mp.has('else') ? mp.at('else') : elseExpr;\n\t    // Optionally choose a specific type from the chain\n\t    const type = mp.at('type') || handler.type;\n\t    // The type must be in *current* handler's chain\n\t    if (!flatChain(handler.type).has(type)) return runIfCode(dispElse);\n\t    // Optionally change op and/or mp\n\t    const rdop = mp.has('op') ? mp.at('op') : handler.op, rdmp = getRDMP(mp), redis = getHandler(type, rdop, type === handler.type && rdop === handler.op);\n\t    // Don't allow switch to default if not changing op\n\t    if (!redis || (!mp.has('op') && redis.op !== rdop)) return runIfCode(dispElse);\n\t    // Looks good; fire the redispatch\n\t    return dispatchHandler(mctx, { octx, op: rdop, handler: redis, sm }, rdmp);\n\t}\n\tcase 'return':\n\t    this.bfn._capture = true;\n\t    throw new MSJSFlow('return', mp.at(0));\n\t    // Not reached\n\tcase 'rr': return mctx.rr;\n\tcase 'rt': return mctx.rt;\n\tcase 'sr': return mctx.sr;\n\tcase 'st': return mctx.st;\n\t}\n\treturn runIfCode(elseExpr);\n    }\n\n    // Prototype @function receiver\n    function jsFnCall (...mp) { return this.bfn('call', new NANOS([...mp])); }\n    function msjsR$Function (op0, mp0) {\n\tconst cmp = canMesgProps({ rr: this.bfn, op: op0, mp: mp0 });\n\tconst { op, mp, hasElse, elseExpr } = cmp;\n\t// Fast-track (call) message\n\tif (op === 'call') return dispatchHandler(cmp, this, mp);\n\tswitch (op) {\t\t// Function-mode ops\n\tcase 'fn':\t\t\t// Return a new function code block\n\t    return newMSJSFunction(this.handler.code, mp);\n\tcase 'jsfn':\t\t// Return a JS wrapper-function\n\t    return (this.jsFn ||= jsFnCall.bind(this));\n\t}\n\tif (hasElse) return runIfCode(elseExpr);\n\tthrow new TypeError(`No Mesgjs handler found for \"@function(${op})\"`);\n    }\n\n    // Prototype @interface receiver\n    function msjsR$Interface (op0, mp0) {\n\tconst name = this.name, { op, mp, hasElse, elseExpr } = canMesgProps({ rr: this.bfn, op: op0, mp: mp0 });\n\tswitch (op) {\n\tcase 'instance': return getInstance(name, mp);\n\tcase 'name': return name;\n\tcase 'set': return setInterface(name, mp, this.isFirst);\n\t}\n\tif (hasElse) return runIfCode(elseExpr);\n\tthrow new TypeError(`No Mesgjs handler found for \"@interface(${op})\"`);\n    };\n\n    /*\n     * Prototype private send-message function\n     * Promote JS receiver objects to Mesgjs, if necessary, and deliver an\n     * attributed message via the message baton.\n     */\n    function msjsS$SendMessage (rr, op, mp) {\n\tif (!rr?.msjsType) rr = gt.$toMSJS(rr);\n\tmesgBaton = { sr: this.sr, st: this.st, rr, op, mp };\n\tlet result;\n\ttry { result = rr(); }\n\tfinally { mesgBaton = undefined; }\n\treturn result;\n    }\n\n    /*\n     * Interface-object implementation to set/change a MSJS object interface\n     *\n     * Parameters:\n     * - abstract - The interface is incomplete and cannot be instantiated\n     * - chain - Sets an ordered chain of super-class interfaces\n     * - final - The interface is final and cannot be chained\n     * - handlers - Message operation handlers to be added\n     * - lock - Lock out future setInterface calls\n     * - once - Prevents returning the interface again and throws an\n     *       error if returned before\n     * - pristine - Throw an error if not the first configuration\n     * - private - The interface is private (instances may only be generated\n     *       via the interface object, not through the core)\n     */\n    function setInterface (name, mp, isFirst) {\n\tif (name[0] === '@' && initPhase !== 1) throw new TypeError(`Cannot configure Mesgjs interface \"${name}\" after runtime initialization`);\n\tconst ix = interfaces[name];\n\tif (mp instanceof NANOS) mp = mp.storage;\n\tif ((mp.once && !isFirst) || (mp.pristine && !ix.pristine)) throw new TypeError(`Mesgjs interface \"${name}\" is not pristine`);\n\tix.pristine = false;\n\tif (ix.locked) throw new TypeError(`Cannot change locked Mesgjs interface \"${name}\"`);\n\n\t// Set the interface chain. Refd guarantees an acyclic graph.\n\tif (mp.chain) {\n\t    if (ix.chain.size) throw new TypeError(`Cannot change chain for Mesgjs interface \"${name}\"`);\n\t    if (ix.refd) throw new TypeError(`Cannot set chain for active Mesgjs interface \"${name}\"`);\n\t    const chain = new Set(Object.values(mp.chain.storage || mp.chain || []));\n\t    for (const item of chain) {\n\t\tif (!interfaces[item]) throw new ReferenceError(`Mesgjs interface \"${name}\" references unknown interface \"${item}\"`);\n\t\tif (interfaces[item].final) throw new TypeError(`Mesgjs interface \"${name}\" tries to extend final interface \"${item}\"`);\n\t\tinterfaces[item].refd = true;\n\t    }\n\t    ix.chain = chain;\n\t}\n\n\t/*\n\t * Add message handlers. These can be either foundational JavaScript\n\t * implementation functions or Mesgjs code blocks.\n\t */\n\tconst opHandlers = mp.handlers || {};\n\tfor (const [ op, handler ] of (opHandlers instanceof NANOS) ? opHandlers.entries() : Object.entries(opHandlers)) {\n\t    if (typeof handler === 'function') {\n\t\tif (handler.msjsType === '@code') {\n\t\t    codeBaton = undefined;\n\t\t    handler(getCode);\n\t\t    if (codeBaton?.code) setRO(ix.handlers[op] = codeBaton.code, 'msjsType', '@handler');\n\t\t}\n\t\telse ix.handlers[op] = handler;\n\t    } else if (handler === false) ix.handlers[op] = false;\n\t}\n\tcodeBaton = undefined;\n\n\tconst cacheHints = mp.cacheHints || {};\n\tfor (const [ op, hint ] of (cacheHints instanceof NANOS) ? cacheHints.entries() : Object.entries(cacheHints)) {\n\t    switch (hint) {\n\t    case true: case false: case 'pin':\n\t\tif (ix.handlers[op]) ix.handlers[op].cache = hint;\n\t\tbreak;\n\t    }\n\t}\n\n\tif (mp.init) ix.init = mp.init;\t// JS instance-init function\n\tif (mp.abstract) ix.abstract = true;\n\tif (mp.final) ix.final = true;\n\tif (mp.lock) ix.locked = true;\n\tif (mp.once) ix.once = true;\n\tif (mp.singleton) ix.singleton = true;\n    }\n\n    // Set module metadata (once) from a plain object or NANOS\n    function setModMeta (meta) {\n\tif (globalThis.msjsModMeta) return;\t// Only set once\n\tsetRO(globalThis, 'msjsModMeta', true);\t// Now subject to mod meta\n\n\t// Deep copy from NANOS or plain object config\n\tif (meta instanceof NANOS) modMeta.push(parseSLID(meta.toSLID()));\n\telse modMeta.push(parseQJSON(JSON.stringify(meta)));\n\n\t// Track features provided by modules\n\taddModFeatures(modMeta.at('modules'));\n\n\t/*\n\t * Allow modules to @c(fwait @loaded) and initiate loading of all\n\t * non-deferred modules. @loaded reflects completion of the loading\n\t * phase (success or failure).\n\t */\n\tconst loaded = getInstance('@promise'), loadPros = [];\n\tfeatures.set('@loaded', loaded);\n\tfor (const mod of modMeta.at('modules').entries()) if (!mod[1].at('defLoad')) loadPros.push(loadModule(mod[0]));\n\tloaded.allSettled(...loadPros);\n    }\n\n    function stub (type, ...names) {\n\tconst h = interfaces[type]?.handlers;\n\tif (h) names.forEach(name => h[name] = false);\n    }\n\n    /*\n     * Check whether an object type accepts a given message operation.\n     * Returns ['specific', type] if there's a specific handler;\n     * ['default', type] if there's a default handler but no\n     * specific handler; or undefined. The type returned is the first\n     * type from the chain that responds, which may be different than\n     * the requested type.\n     */\n    function typeAccepts (type, op) {\n\tif (op === undefined) {\n\t    const ix = interfaces[type];\n\t    return ((ix && !ix.private) ? [...Object.keys(ix.handlers)] : undefined);\n\t}\n\tconst handler = getHandler(type, op);\n\tif (handler) return [ handler.type, handler.op === '@default' ? 'default': 'specific' ];\n    }\n\n    // Return whether the flat-chain for type 1 includes type 2.\n    function typeChains (type1, type2) {\n\tif (interfaces[type1]?.private) return;\n\tif (type2 === undefined) return (interfaces[type1] ? Array.from(interfaces[type1].chain) : undefined);\n\treturn flatChain(type1).has(type2);\n    }\n\n    return {\n\tdebugConfig,\n\tfcheck,\n\tfready,\n\tfwait,\n\tgetInstance: coreGetInstance,\n\tgetInterface,\n\tinitialize,\n\tlogInterfaces,\n\tloadModule,\n\tmoduleScope,\n\tsetModMeta,\n\ttypeAccepts,\n\ttypeChains,\n    };\n})();\n//////////////////////////////////////////////////////////////////////\n// END Of Code/Interface/Messaging Protected Zone\n//////////////////////////////////////////////////////////////////////\n\nsetRO(globalThis, {\n    $f: false, $gss: new NANOS(), $n: null, $t: true, $u: undefined,\n    $modScope: moduleScope,\n});\n\n/*\nvim:syntax=javascript:sw=4\n*/\n"],
  "mappings": "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",
  "names": ["calcDigest", "getIntegritySHA512", "NANOS", "isIndex", "parseQJSON", "parseSLID", "SieveCache", "unifiedList", "gt", "msjsInstance", "MSJSFlow", "message", "info", "MSJSFlowError", "a", "calcIntegrity", "src", "fetchModule", "host", "path", "decode", "integrity", "data", "listFromPairs", "pa", "loggedType", "v", "jt", "namespaceAt", "namespace", "key", "opt", "runIfCode", "sendAnonMessage", "rr", "op", "mp", "senderFLC", "stack", "srFrame", "match", "sROProp", "setRO", "o", "map", "enumerable", "k", "value", "throwFlow", "d", "type", "ifName", "js", "hasOwn", "debugConfig", "fcheck", "fready", "fwait", "getInstance", "getInterface", "initialize", "loadModule", "logInterfaces", "moduleScope", "setModMeta", "typeAccepts", "typeChains", "codeBaton", "mesgBaton", "nextAnon", "nextUCID", "initPhase", "dispNo", "getCode", "initSym", "interfaces", "firstInit", "dbgCfg", "hdr", "handlerCache", "dacHandMctx", "modLoaded", "features", "modMeta", "modMap", "addModFeatures", "mods", "modKey", "modInf", "f", "prom", "appendStackTrace", "frames", "stop", "down", "up", "curFrm", "disp", "dispOp", "fmtDispParams", "fmtDispSrc", "bindCode", "tpl", "newMSJSCode", "canMesgProps", "ctx", "checkBaton", "sr", "st", "rt", "hasElse", "elseExpr", "mb", "hp", "prop", "coreGetInstance", "ix", "set", "dispProto", "dispatchHandler", "mctx", "dhctx", "octx", "handler", "sm", "bfnThis", "msjsR$Dispatch", "trace", "thisDisp", "result", "e", "dispatchMessage", "dctx", "cmp", "getHandler", "msjsS$SendMessage", "stub", "flatChain", "fc", "nxt", "inc", "list", "en", "flc", "proms", "mid", "meta", "type0", "next", "noopHandler", "cacheKey", "hit", "getHandler2", "dacHand", "defHand", "code", "pi", "name", "isFirst", "bfn", "msjsR$Interface", "setInterface", "getRDMP", "raw", "cb", "expect", "remapModURL", "URL", "mod", "m", "per", "tra", "b", "getPer", "getTra", "cd", "od", "msjsR$Code", "newMSJSFunction", "ps", "msjsR$Function", "url", "prefixMap", "best", "input", "output", "len", "version", "major", "dir", "base", "op0", "mp0", "_dmp", "dispElse", "rdop", "rdmp", "redis", "jsFnCall", "chain", "item", "opHandlers", "cacheHints", "hint", "loaded", "loadPros", "names", "h", "type1", "type2"]
}
