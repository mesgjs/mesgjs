import{debugConfig as u,fcheck as m,fready as d,fwait as v,getInstance as i,getInterface as f,getModMeta as A,logInterfaces as E,modHasCap as g,runIfCode as s,runWhileCode as h,setModMeta as M,setRO as w,typeAccepts as l,typeChains as y}from"./runtime.esm.js";import{NANOS as C,parseQJSON as O,parseSLID as T}from"./vendor.esm.js";function q(o){const{mp:e}=o;let t=!0;for(const n of e.values())if(t=s(n),!t)return t;return t}function k(o){const{mp:e}=o,t=e.at("collect");let n=t?new C:void 0;const c=r=>{t?n.push(r):n=r},a=async()=>{for(const r of e.values())c(await s(r))},p=i("@promise");return a().then(()=>p.resolve(n)),p}function I(o){const{mp:e}=o,t=e.at(0),n=t?.msjsType,c=e.next-1,a=l(n,"caseEq")?"caseEq":l(n,"eq")?"eq":void 0,p=a?r=>t(a,r):r=>t===r;for(let r=1;r<c;r+=2)if(p(s(e.at(r))))return s(e.at(r+1));return s(e.at("else"))}function b(o){const{mp:e}=o;return i(e.at(0),e.at("init"))}function j(o){const{mp:e}=o,t=e.next-1;for(let n=0;n<t;n+=2)if(s(e.at(n)))return s(e.at(n+1));if(e.has("else"))return s(e.at("else"));if(e.next%2)return s(e.at(t))}function x(o){const{mp:e}=o;let t=!1;for(const n of e.values())if(t=s(n),t)return t;return t}function H(o){const{mp:e}=o,t=e.at("collect");let n=t?new C:void 0;const c=a=>{t?n.push(a):n=a};if(e.at("repeat"))for(const a of e.values())c(h(a));else for(const a of e.values())c(s(a));return n}function N(o){const{mp:e}=o,t=e.at(0);throw t instanceof Error?t:new Error(t)}function R(o){const{mp:e}=o;let t=!1;for(const n of e.values()){const c=s(n);if(c){if(t)return!1;t=c}}return t}function D(o){f(o).set({final:!0,lock:!0,pristine:!0,singleton:!0,handlers:{_:e=>e.mp.at(0),"&":q,":":I,"+":b,"?":j,"~":e=>!s(e.mp.at(0)),"|":x,and:q,await:k,case:I,debug:e=>u(e.mp),fcheck:e=>m(e.mp.at(0)),fwait:e=>v(...e.mp.values()),fready:e=>d(e.mp.at("mid"),e.mp.at(0)),get:b,if:j,interface:e=>f(e.mp.at(0)),log:e=>console.log(...e.mp.values()),logErr:e=>console.error(...e.mp.values()),logInterfaces:E,logWarn:e=>console.warn(...e.mp.values()),modHasCap:e=>g(e.mp.at(0),e.mp.at(1)),not:e=>!s(e.mp.at(0)),or:x,qjson:e=>O(e.mp.at(0,"")),run:H,slid:e=>T(e.mp.at(0,"")),throw:N,type:e=>globalThis.$toMsjs(e.mp.at(0))?.msjsType,typeAccepts:e=>l(e.mp.at(0),e.mp.at(1)),typeChains:e=>y(e.mp.at(0),e.mp.at(1)),xor:R},cacheHints:{":":"pin","+":"pin","?":"pin",case:"pin",get:"pin",if:"pin"}}),o==="@core"&&(w(globalThis,"$c",i("@core")),Object.assign($c,{debugConfig:u,fcheck:m,fready:d,fwait:v,getInstance:i,getInterface:f,getModMeta:A,modHasCap:g,runIfCode:s,runWhileCode:h,setModMeta:M,setRO:w,typeAccepts:l,typeChains:y}))}export{D as install};
