import{debugConfig as b,fcheck as l,fready as u,fwait as m,getInstance as f,getInterface as i,logInterfaces as j,runIfCode as r,runWhileCode as g,setRO as v,typeAccepts as c,typeChains as h}from"./runtime.esm.js";import{NANOS as x,parseQJSON as E,parseSLID as O}from"./vendor.esm.js";function d(n){const{mp:e}=n;let t=!0;for(const o of e.values())if(t=r(o),!t)return t;return t}function y(n){const{mp:e}=n,t=e.at(0),o=t?.msjsType,p=e.next-1,s=c(o,"caseEq")?"caseEq":c(o,"eq")?"eq":void 0,I=s?a=>t(s,a):a=>t===a;for(let a=1;a<p;a+=2)if(I(r(e.at(a))))return r(e.at(a+1));return r(e.at("else"))}function w(n){const{mp:e}=n;return f(e.at(0),e.at("init"))}function q(n){const{mp:e}=n,t=e.next-1;for(let o=0;o<t;o+=2)if(r(e.at(o)))return r(e.at(o+1));if(e.has("else"))return r(e.at("else"));if(e.next%2)return r(e.at(t))}function C(n){const{mp:e}=n;let t=!1;for(const o of e.values())if(t=r(o),t)return t;return t}function T(n){const{mp:e}=n,t=e.at("collect");let o=t?new x:void 0;const p=s=>{t?o.push(s):o=s};if(e.at("repeat"))for(const s of e.values())p(g(s));else for(const s of e.values())p(r(s));return o}function A(n){const{mp:e}=n,t=e.at(0);throw t instanceof Error?t:new Error(t)}function k(n){const{mp:e}=n;let t=!1;for(const o of e.values()){const p=r(o);if(p){if(t)return!1;t=p}}return t}function S(n){i(n).set({final:!0,lock:!0,pristine:!0,singleton:!0,handlers:{_:e=>e.mp.at(0),"&":d,":":y,"+":w,"?":q,"~":e=>!r(e.mp.at(0)),"|":C,and:d,case:y,debug:e=>b(e.mp),fcheck:e=>l(e.mp.at(0)),fwait:e=>m(...e.mp.values()),fready:e=>u(e.mp.at("mid"),e.mp.at(0)),get:w,if:q,interface:e=>i(e.mp.at(0)),log:e=>console.log(...e.mp.values()),logErr:e=>console.error(...e.mp.values()),logInterfaces:j,logWarn:e=>console.warn(...e.mp.values()),not:e=>!r(e.mp.at(0)),or:C,qjson:e=>E(e.mp.at(0,"")),run:T,slid:e=>O(e.mp.at(0,"")),throw:A,type:e=>globalThis.$toMsjs(e.mp.at(0))?.msjsType,typeAccepts:e=>c(e.mp.at(0),e.mp.at(1)),typeChains:e=>h(e.mp.at(0),e.mp.at(1)),xor:k},cacheHints:{":":"pin","+":"pin","?":"pin",case:"pin",get:"pin",if:"pin"}}),n==="@core"&&(v(globalThis,"$c",f("@core")),Object.assign($c,{fcheck:l,fready:u,fwait:m,getInstance:f,getInterface:i,runIfCode:r,runWhileCode:g,setRO:v,typeAccepts:c,typeChains:h}))}export{S as install};
