import{debugConfig as u,fcheck as m,fready as g,fwait as h,getInstance as f,getInterface as i,logInterfaces as d,runIfCode as r,setRO as v,typeAccepts as p,typeChains as y}from"./runtime.esm.js";import{NANOS as w,parseQJSON as q,parseSLID as C}from"./vendor.esm.js";function I(n){const{mp:e}=n;let t=!0;for(const o of e.values())if(t=r(o),!t)return t;return t}function T(n){const{mp:e}=n,t=e.at(0),o=t?.msjsType,c=e.next-1,s=p(o,"caseEq")?"caseEq":p(o,"eq")?"eq":void 0,l=s?a=>t(s,a):a=>t===a;for(let a=1;a<c;a+=2)if(l(r(e.at(a))))return r(e.at(a+1));return r(e.at("else"))}function x(n){const{mp:e}=n;return f(e.at(0),e.at("init"))}function E(n){const{mp:e}=n,t=e.next-1;for(let o=0;o<t;o+=2)if(r(e.at(o)))return r(e.at(o+1));if(e.has("else"))return r(e.at("else"));if(e.next%2)return r(e.at(t))}function S(n){const{mp:e}=n;let t=!1;for(const o of e.values())if(t=r(o),t)return t;return t}function b(n){const{mp:e}=n,t=e.at("collect");let o=t?new w:void 0;const c=s=>{t?o.push(s):o=s};if(e.at("repeat"))for(const s of e.values())c(O(s));else for(const s of e.values())c(r(s));return o}function j(n){const{mp:e}=n,t=e.at(0);throw t instanceof Error?t:new Error(t)}function A(n){const{mp:e}=n;let t=!1;for(const o of e.values()){const c=r(o);if(c){if(t)return!1;t=c}}return t}function O(n){for(;n?.msjsType==="@code";)n=n("run");return n}function R(n){i(n).set({final:!0,lock:!0,pristine:!0,singleton:!0,handlers:{_:e=>e.mp.at(0),and:I,case:T,debug:e=>u(e.mp),fcheck:e=>m(e.mp.at(0)),fwait:e=>h(...e.mp.values()),fready:e=>g(e.mp.at("mid"),e.mp.at(0)),get:x,if:E,interface:e=>i(e.mp.at(0)),log:e=>console.log(...e.mp.values()),logErr:e=>console.error(...e.mp.values()),logInterfaces:d,logWarn:e=>console.warn(...e.mp.values()),not:e=>!r(e.mp.at(0)),or:S,qjson:e=>q(e.mp.at(0,"")),run:b,slid:e=>C(e.mp.at(0,"")),throw:j,type:e=>globalThis.$toMSJS(e.mp.at(0))?.msjsType,typeAccepts:e=>p(e.mp.at(0),e.mp.at(1)),typeChains:e=>y(e.mp.at(0),e.mp.at(1)),xor:A},cacheHints:{case:"pin",get:"pin",if:"pin"}}),n==="@core"&&v(globalThis,"$c",f("@core"))}export{R as install};
